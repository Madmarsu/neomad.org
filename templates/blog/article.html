{% extends 'layout.html' %}

{% block extra_css %}
<link rel=stylesheet href={{ url_for('static', filename='css/article.css') }}>
{% endblock %}

{% block main %}
<article>
  <section class=meta>
    <a href=#>
      <img class=avatar src=https://cdn-images-1.medium.com/fit/c/60/60/0*LX5hEUi7QzID3ymC.jpeg>
    </a>
    <div>
      <a href=# class=author>{{ article.author }}</a>
      <p>{{ article.author.about }}</p>
      <time datetime={{ article.creation_date }} pubdate>{{ article.creation_date|datetime }}</time>
    </div>
  </section>

  <h1 contenteditable={{edit|boolean}} name=title>{{ article.title or 'Article title' }}</h1>

  <div class=content name=content>
    {{ article.content|safe or '<p>Insert your content here</p>'|safe }}
  </div>
</article>

{% if edit %}
<script src="//cdn.jsdelivr.net/medium-editor/latest/js/medium-editor.min.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/medium-editor/latest/css/medium-editor.min.css" type="text/css" media="screen" charset="utf-8">

<link rel=stylesheet href=//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/medium-editor/5.23.0/css/themes/tim.min.css>
<link rel=stylesheet href=https://cdn.rawgit.com/orthes/medium-editor-insert-plugin/3.0/dist/css/medium-editor-insert.min.css>
<script src=https://cdn.rawgit.com/orthes/medium-editor-insert-plugin/3.0/dist/js/medium-editor-insert.min.js></script>
<form method=post action="" edit>
  <input type=hidden name=title>
  <input type=hidden name=content>
  <button type=submit>Save</button>
</form>
<script>
  var markDownEl = document.createElement('div')
  var editor = new MediumEditor('.content', {
    toolbar: {
      buttons: ['h2', 'h3', 'bold', 'italic', 'anchor', 'quote']
    },
    extensions: {
      insert: new MediumEditorInsert()
    }
  });
  document.forms[0].addEventListener('submit', event => {
    event.target.title.value = document.querySelector('[contenteditable][name=title]').innerHTML
    event.target.content.value = document.querySelector('[contenteditable][name=content]').innerHTML
  })
</script>
{% endif %}
{% endblock %}
